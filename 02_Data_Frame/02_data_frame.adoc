= 데이터 프레임(Data Frame)

== Data Frame

* 데이터를 다룰 때 가장 많이 사용하는 데이터 형태
* 열(column)과 행(row)로 구성된 매트릭스(Matrix) 형태의 표
** 열은 column, variable로 불리며, 세로로 나열되는 열을 나타냄
** 행은 row, case로 불리며, 각 데이터 객체를 나타냄

image:./images/image01.png[data, 600]

== Data Frame 생성 (List)

* list 사용
** column 이름이 정수형으로 지정됨

[source, python]
----
import pandas as pd

df = pd.DataFrame([ ['Celine', 'France', 90],
                    ['James', 'UK', 80],
                    ['Jason', 'USA', 20],
                    ['Hans', 'Germany', 40]])
----

[%header, cols=4, width=50%]
|===
|  | 0 | 1 | 2
|0 |Celine |France | 90
|1 |James  |UK | 80
|2 |Jason  |USA|20
|3 |Hans   |Germany|40
|===

== Data Frame 생성 (Dictionary)

* Dictionary 사용

[source, python]
----
import pandas as pd

df = pd.DataFrame({'name'  :['Celine', 'James', 'Jason', 'Hans'],
                    'nation':['France', 'UK', 'USA', 'Germany'],
                    'grade' :[90, 80, 20, 40]})
----

[%header, cols=4, width=50%]
|===
|  |name   |nation | grade
|0 |Celine |France | 90
|1 |James  |UK | 80
|2 |Jason  |USA|20
|3 |Hans   |Germany|40
|===

== Data Frame 생성 (Dictionary + index)

** 이름을 key로 사용

[source, python]
----
import pandas as pd

df = pd.DataFrame({'nation':['France', 'UK', 'USA', 'Germany'],
                    'grade' :[90, 80, 20, 40]})
df.index = ['Celine', 'James', 'Jsaon', 'Hans']
----

[%header, cols=3, width=40%]
|===
|  |nation | grade
|Celine |France | 90
|James  |UK | 80
|Jason  |USA|20
|Hans   |Germany|40
|===

== Data Frame

* Column에 액세스 +
[source, python]
----
df[0]
0    Celine
1     James
2     Jason
3      Hans
----

* Row에 액세스 +
[source, python]
----
# Index로 접근
df.iloc[0]
nation    France
grade         90
----
[source, python]
----
# Key로 접근
df.iloc['Celine']
nation    France
grade         90
----

== Data Frame

* 함수 
** 집계 
+
[source, python]
----
sum(df['math'])
230
----
** 평균 
+
[source, python]
----
sum(df['math']) / len(df)
----
** 전체 데이터 평균 
+ 
[source, python]
----
df.mean()
math       57.5
english    82.5
science    80.0
----

** 전체 데이터 설명
+
[source, python]
----
df2.describe()
            math     english     science
count   4.000000    4.000000    4.000000
mean   57.500000   82.500000   80.000000
std    33.040379   17.078251   33.665016
min    20.000000   60.000000   30.000000
25%    35.000000   75.000000   75.000000
50%    60.000000   85.000000   95.000000
75%    82.500000   92.500000  100.000000
max    90.000000  100.000000  100.000000
----

== 연습문제

* 아래 데이터를 Data Frame으로 작성하세요 +
[%header, cols=3, width=50%]
|===
|product|price|sales_volume
|Apple  |1800 | 24
|Strawberry | 1500 |38
|Watermelon | 3000 |13
|===
* 과일의 가격 평균과 판매량 평균을 구하세요

== 외부 데이터 사용

* excel 파일 적재 : read_excel 함수 사용
+
[source, python]
----
# 단순 파일 적재
df_titanic = pd.read_excel('titanic.xls')
# worksheet 적재
df_titanic = pd.read_excel('titanic.xls', sheet_name='titanic3')
df_titanic = pd.read_excel('titanic.xls', sheet_name=0) # worksheet index
# header(컬럼 이름)이 없는 경우
df_titanic = pd.read_excel('titanic.xls', header=None)
----

* csv 파일 적재 : read_csv 함수 사용
+
[source, python]
----
# 단순 파일 적재 (기본 구분자: ',')
df_pop202309 = pd.read_csv('population202309.csv')
# 구분자 사용
df_pop202309 = pd.read_csv('population202309.csv', sep='|')
----

== 데이터 구조

[%header, cols="1,2", width=50%]
|===
|함수|기능
|head()|데이터의 앞부분 출력
|tail()|데이터의 뒷부분 출력
|shape |행, 열 개수 출력
|info()|변수 속성 출력
|describe()|요약 통계량 출력
|===

== 데이터 구조

[source, python]
----
# 처음 지정된 개수의 row (기본값 5)
df_pop202309.head()
df_pop202309.head(10)

# 마지막 지정된 개수의 row (기본값 5)
df_pop202309.tail()
df_pop202309.tail(15)

# Data Frame의 메소드(함수)가 아닌 속성(Attribute)
df_pop202309.shape

# Data Frame의 컬럼 속성
df_pop202309_info()

# 요약 통계량
df_pop202309.describe()
----

== 구조 변환

* Data Frame 복사본 생성: _copy()_ 메소드
+
[source, python]
----
df_pop = df_pop202309.copy()
----
+
* 컬럼명 변경: _rename()_ 메소드
[source, python]
----
df_pop = df_pop.rename(columns= {'행정구역':'district'})
df_pop.rename(columns={'총인구수':'population','세대수':'household'}, inplace=True)
df.columns = ['district','population','household','pop_household','male','female','gener_ratio']
----

== 타입 변환

* 컬럼 타입 확인: _dtypes_ 속성
+
[source, python]
----
df_pop.dtypes
----

* 컬럼 타입 변환: _astype_ 메소드
+
[source, python]
----
df_pop['population'] = df_pop.population.str.replace(',','').astype('int')
df_pop.household = df_pop.household.str.replace(',','').astype('int')
df_pop.male = df_pop.male.str.replace(',','').astype('int')
df_pop.female = df_pop.female.str.replace(',','').astype('int')
----

== 컬럼 추가

* 계산된 컬럼 추가
+
[source, python]
----
df_pop['gender_ratio'] = round(df_pop['male'] / df_pop['female'], 2)
----